version: "3.9"

services:
  # --- SERVEUR DHCP ---
  dhcp:
    image: dhcp-server-image   # ton image déjà configurée
    container_name: dhcp
    cap_add:
      - NET_ADMIN
    networks:
      lan_entreprise:
        ipv4_address: 120.0.80.7

  # --- CLIENTS ---
  client1:
    build:
      context: .
      dockerfile: clients/Dockerfile
      args:
        CLIENT_NAME: client1
    container_name: client1
    cap_add:
      - NET_ADMIN
    privileged: true
    command: bash -c "dhclient eth0 && sleep infinity"
    networks:
      - lan_entreprise

  client2:
    build:
      context: .
      dockerfile: clients/Dockerfile
      args:
        CLIENT_NAME: client2
    container_name: client2
    cap_add:
      - NET_ADMIN
    privileged: true
    command: bash -c "dhclient eth0 && sleep infinity"
    networks:
      - lan_entreprise

  # --- DNS et les autres services (à compléter) ---

# --- RÉSEAUX ---
networks:
  lan_entreprise:   
    driver: bridge
    ipam:
      config:
        - subnet: 120.0.80.0/24

